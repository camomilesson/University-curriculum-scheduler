# Uni Module Scheduler (PoC)

A Python proof-of-concept for scheduling a university’s courses across **14 modules** (3-week blocks). The scheduler attempts to satisfy the following constraints and preferences:

- **Teacher availability** per module (`1/0/-1`)
- **Teacher capacity** (how many modules they can teach)
- **Prerequisite chains / DAGs**
- **Celebrity courses** pinned to specific module + teacher
- **Module capacity** (default: up to 9 courses per module)
- **No chain courses in celebrity modules** (module-level rule)
- **Chain wrapping across years** using “layers” (e.g., freshmen year → layer 0, sophomore → layer 1)

Outputs include a final schedule CSV plus a soft-violations report (courses placed using `0` availability).

---

## Project structure

```
.  # repo root
├── main.py                # orchestration entrypoint
├── data_loaders.py        # CSV parsing and builders (moved from main)
├── classes/               # domain objects and scheduler engine
│   ├── __init__.py
│   ├── teacher.py
│   ├── course.py
│   ├── module.py
│   └── scheduler.py
├── csvs/                  # example CSV inputs used by the PoC
│   ├── teacher_availability.csv
│   ├── course_teacher.csv
│   ├── prereqs_CSDS.csv
│   └── celebrity_courses.csv
├── out_schedule.csv       # generated by running the scheduler
├── out_soft_violations.csv
├── README.md
├── requirements.txt
├── .gitignore
└── LICENSE
```

> `out_schedule.csv` and `out_soft_violations.csv` are generated when you run the scheduler.

---

## Input CSV formats

Below are the formats expected by the loader functions in `data_loaders.py`.

### 1) `csvs/teacher_availability.csv`

Header required:

```csv
name,M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,M13,M14,capacity
```

M1..M14 values:

- `1` = available (preferred)
- `0` = soft-available (allowed but flagged)
- `-1` = forbidden

`capacity` is the total number of modules the teacher can teach in the year.

Example:

```csv
Alexey Davydov,1,0,1,0,1,0,1,0,1,0,1,0,1,0,2
```

### 2) `csvs/course_teacher.csv`

Each row is:

```
course_name,teacher1,teacher2,...
```

Example:

```csv
Intro to Programming 1: Python,Ogabek Masharipov,Andrey Danilov
```

### 3) `csvs/prereqs_CSDS.csv`

Row formats:

- If the course has prereqs:

```
course_name,min_layer,prereq1,prereq2,...
```

- If it has no prereqs but should still be treated as part of chains:

```
course_name,min_layer
```

`min_layer` indicates the earliest academic layer (0-based) in which the course may appear.

Example:

```csv
Calculus 1,0,Intro to Higher Mathematics
Mobile Development,1,Programming: Java / Kotlin
```

### 4) `csvs/celebrity_courses.csv`

Each row is pinned during Pass 1 and must include a module and a teacher:

```
course_name,module,teacher_name
```

Example:

```csv
From Zero to Hero,1,Kamran Elahian
Example Course on Startup Fundraising,7,Stephanie Hospital
```

---

## Scheduling passes (high level)

- Pass 1 — Celebrity placement: place pinned courses from `celebrity_courses.csv`.
- Pass 2 — Chain scheduling: schedule courses that belong to prerequisite chains (DAGs). Uses a layered model where absolute time = `layer * 14 + module`.
- Pass 3 — Solitary courses: fill remaining courses using emptiest-module-first balancing. Runs a strict (availability==1) pass, then a soft fallback (availability==0).

---

## How to run

1. Create and activate a virtualenv (recommended):

```bash
python3 -m venv .venv
source .venv/bin/activate
```

2. Install dependencies (currently none outside stdlib but keep the file):

```bash
pip install -r requirements.txt
```

3. Run the scheduler:

```bash
python main.py
```

You should see a per-module printed schedule, a summary, and two output CSV files written to the repo root: `out_schedule.csv` and `out_soft_violations.csv`.

---

## Outputs

- `out_schedule.csv`: one row per assigned course with module, course name, teacher, and an optional flag when soft availability (0) was used.
- `out_soft_violations.csv`: rows for assignments that used availability `0` so staff can review/confirm.

---

## Development notes

- I recently moved all CSV parsing and object-building helpers into `data_loaders.py` to keep `main.py` small and easy to test. If you write tests, you can call the loader functions directly and provide alternate CSV fixtures.
- The scheduler (`classes/scheduler.py`) implements a greedy heuristic; it is intentionally simple and fast but not guaranteed optimal.

### Quick API (useful for tests)

- `data_loaders.build_teachers()` → dict[name, Teacher]
- `data_loaders.build_courses(teachers)` → dict[name, Course]
- `data_loaders.build_modules()` → dict[module_num, Module]
- `data_loaders.load_celebrity_courses()` → list[(course_name, module_num, teacher_name)]
- `data_loaders.debug_state(teachers, courses, modules)` → prints a short summary (dev helper)

---

## Notes on requirements / license

`requirements.txt` is intentionally minimal (stdlib-only) at the moment. Add pinned dependencies there when needed.

License: MIT — see `LICENSE` in the repository.